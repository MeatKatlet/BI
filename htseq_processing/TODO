###########
#идем по всем экзонам, у каждого получаем id гена,
#array[id Гена] += длина экзона(end - start)
#получим массив со всеми генами и длинной каждого гена(сумма длин экзонов)
#длина гена - 100%
#позиция выравнивания рида это x %

#если все сигарные строки пересекаются с 1 геном(проверить на выход из границ гена, что будет?), только после того как мы убедимся в этом, то берем позицию первой сигарной строки за начало рида и от этого считаем % позиции в риде!
# в строке 279 оринтировочно проверяется окончательно картирование рида на (пары?) только на 1 ген, надо еще проверить не вылезает ли он за пределы гена(провести примерный эксперимент!)

#на графике по оси - x будет точки процентов, по оси y сколько ридов легло с таким %, надо посмотреть как строиться этот график,
#можно разделить на интервалы и посмотреть сколько попадает точек в интервал
#чтобы определить покрытие надо находить пересекающиеся риды по интервалам


#matplotlib.pyplot.eventplot
#errorbar - рисует несколько линий в одной fig и показывает размах данных через errorbar

multiprocessing будем делать потом

TODO самый быстрый алгоритм получения пересекающихся отрезков!!
https://stackoverflow.com/questions/4446112/search-for-interval-overlap-in-list-of-intervals

TODO тестировать интервалы экзонов на непересекаемость на то что они не состыкуются вместе
похоже ошибка в том что точки покрытия 10 20 30 ... расчитаны в абсолютных координатах, а риды сравниваются с ними относительно начала гена(вычитание координаты начала гена из координаты начала рида)
как такое тестировать заранее?
TODO поставить ограничение на бинарный поиск в 10, если > 10 значит что то не так идет
TODO строка 186 проверка на отрицательность first_read.iv.length! и second_read.iv.length


TODO plot coverge как в примере htseq только на ген ENSG00000000003.10


