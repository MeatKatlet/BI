###########
#идем по всем экзонам, у каждого получаем id гена,
#array[id Гена] += длина экзона(end - start)
#получим массив со всеми генами и длинной каждого гена(сумма длин экзонов)
#длина гена - 100%
#позиция выравнивания рида это x %

#если все сигарные строки пересекаются с 1 геном(проверить на выход из границ гена, что будет?), только после того как мы убедимся в этом, то берем позицию первой сигарной строки за начало рида и от этого считаем % позиции в риде!
# в строке 279 оринтировочно проверяется окончательно картирование рида на (пары?) только на 1 ген, надо еще проверить не вылезает ли он за пределы гена(провести примерный эксперимент!)

#на графике по оси - x будет точки процентов, по оси y сколько ридов легло с таким %, надо посмотреть как строиться этот график,
#можно разделить на интервалы и посмотреть сколько попадает точек в интервал
#чтобы определить покрытие надо находить пересекающиеся риды по интервалам


#matplotlib.pyplot.eventplot
#errorbar - рисует несколько линий в одной fig и показывает размах данных через errorbar

TODO тестировать интервалы экзонов на непересекаемость на то что они не состыкуются вместе
TODO поставить ограничение на бинарный поиск в 10, если > 10 значит что то не так идет
TODO строка 186 проверка на отрицательность first_read.iv.length! и second_read.iv.length
TODO поставить только проверку на правильность координат 2 ридов в паре, проверить на скорость

TODO испытать обычный поиск без бинарного



---------------------
TODO multiprocessong, поделить файл на хромосомы и считывать из каждой,
как избежать разделения памяти в воркерах?
1.строить в каждом воркере свой словарь из имен генов?

    считывать из gff нужный участок? индексирование gff нужно?

2. или пройтись 1 раз по gff каким то образом проиндексировать его чтобы получать гены(экзоны) только в нужных интервалах!

    в воркере будем строить список генов только для этого участка!

3. shared memory для списка генов + Lock на каждое += coverage
    lock не обязательно , если чтение/запись будут идти из разных индексов(регионов)

4. если много ридов выровнено на 1 участок, то многопоточность может не помочь и тогда надо считывать из файла по количеству записей а не по координатам интервала!
    - индексировать файл? можно делить файл на части по количеству байт, находить ближайшую начинающуюся строку
    - делить файл на части по количеству строк(как его получить?) из каждой строки в htseq можно получить объект выравнивания используя метод библиотеки htseq
    -










##sequence-region chr1 1 249250621

chr1	HAVANA	exon	249230780	249231242	.	+	.	ID=exon:ENST00000430973.1:1;Parent=ENST00000430973.1;gene_id=ENSG00000233084.2;transcript_id=ENST00000430973.1;gene_type=pseudogene;gene_status=KNOWN;gene_name=AL672183.2;transcript_type=processed_pseudogene;transcript_status=KNOWN;transcript_name=AL672183.2-001;exon_number=1;exon_id=ENSE00001666859.1;level=1;havana_gene=OTTHUMG00000040422.1;havana_transcript=OTTHUMT00000097297.1;ont=PGO:0000004;tag=pseudo_consens
##sequence-region chr2 1 243199373